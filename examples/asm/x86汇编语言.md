# x86汇编语言
## 实模式
### 通用寄存器
AX、BX、CX、DX、SI、DI、BP、SP
### 内存分段机制
CS（代码段寄存器）
DS（数据段寄存器）
ES（附加段寄存器）

16位物理地址只能访问64KB的内存，地址范围是 `0000H` ~ `FFFFH`，65535字节。

8086提供20位的物理地址，在形成物理地址时，先将段寄存器的内容左移4位，然后再同16位的偏移地址相加，得到20位地址。

复位将CS的内容为 `0xFFFF`，其他都为 `0x0000`

动态随机访问寄存器（DRAM）

只读存储器（ROM），在8086中，其占据顶端64KB（`0xF0000` ~ `0xFFFFF`），这样加电复位时，第一条指令是 `0xFFFF0`（CS= `0xFFFF`，IP= `0x0000`）

```nasm
jmp 0xf000:0x305b
; 0xf0000 是要跳转到的段地址
; 0x305b 是目标代码段内的偏移地址
```

`0xA0000` ~ `0xEFFFF`（320KB）提供给外围设备。

`0xB8000` ~ `0xBFFFF` 是留给显卡的。
由于历史的原因，所有在个人计算机上使用的显卡，在加电自检后都会把自己初始化到 `80x25` 的文本模式

```nasm
mov 段寄存器，通用寄存器
mov 段寄存器，内存单元
```

```nasm
;es寄存器指向文本模式的显示缓冲区
mov ax,0xb800
mov es,ax

;以下显示字符串"Label offset:"
;字符的显示属性分为两个字节
;第一个字节是字符的ASCII码，第二个字节是字符的显示属性
;下面的0x07表示字符以黑底白字，无闪烁无加亮的方式显示
mov byte [es:0x00],'L'
mov byte [es:0x01],0x07
```

使用 `movsb`  `movsw`，原始数据串由DS指定，偏移地址由SI指定（DI:SI），目的地址为（ES:DI）

```nasm
; db byte (1 byte)
; dw word (8 byte)
; dd doble word (2 word)
; dq quad word (4 word)

mytext db ‘L’, 0x07
number db 0, 0, 0, 0, 0
; ...
mov si, mytext
mov di, 0

mov cox, (number - mytext) / 2
rep movsw
```
